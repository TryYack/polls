{"version":3,"file":"static/webpack/static/development/pages/create.js.72f1883dd5d30a8e2db9.hot-update.js","sources":["webpack:///./pages/create.js"],"sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { useRouter, withRouter } from 'next/router'\nimport Head from 'next/head'\nimport fetch from 'isomorphic-unfetch'\nimport { Button, Error, Loading, Notification, Spinner } from '@weekday/elements'\nimport gql from 'graphql-tag'\nimport { Query } from 'react-apollo'\nimport withData from '../config'\nimport PollComponent from '../components/poll.component'\nimport FormComponent from '../components/form.component'\nimport { useMutation, useSubscription } from '@apollo/react-hooks'\nimport { closeAppModal } from '../util'\n\nconst ADD_POLL = gql`\n  mutation add_poll($objects: [polls_insert_input!]!) {\n    insert_polls(objects: $objects) {\n      returning {\n        id\n        title\n      }\n    }\n  }\n`;\n\nfunction Create(props) {\n  // ?userId=5db7e3c98476242154d43181&channelId=5db87f04db059a6d8dc8d068\n  const { router: { query }} = props\n  const [userId, setUserId] = useState(query.userId)\n  const [channelId, setChannelId] = useState(query.channelId)\n  const [addPoll, { data }] = useMutation(ADD_POLL)\n\n  return (\n    <React.Fragment>\n      <Head>\n        <title>Polls</title>\n        <meta name=\"viewport\" content=\"initial-scale=1.0, width=device-width\" />\n        <link href=\"/static/css/styles.css\" rel=\"stylesheet\" />\n        <link href=\"/static/images/favicon.png\" rel=\"shortcut icon\" />\n      </Head>\n\n      <style global jsx>{`\n        * {\n          margin: 0px;\n          padding: 0px;\n        }\n\n        html, body {\n          background: white;\n          height: 100%;\n        }\n\n        .complete-container {\n          background: white;\n          width: 100%;\n          height: 100%;\n          position: absolute;\n          left: 0px;\n          top: 0px;\n          display: flex;\n          align-items: center;\n          flex-direction: column;\n          align-content: center;\n          justify-content: center;\n        }\n\n        .container {\n          background: white;\n          width: 100%;\n          height: 100%;\n          position: absolute;\n          left: 0px;\n          top: 0px;\n          display: flex;\n          align-items: stretch;\n          align-content: center;\n          justify-content: center;\n        }\n\n        .error {\n          position: absolute;\n          top: 0px;\n          left: 0px;\n          width: 100%;\n        }\n\n        .polls-listing-container {\n          flex: 1;\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          align-content: center;\n          justify-content: flex-start;\n          padding: 20px;\n        }\n      `}</style>\n\n      {data &&\n        <div className=\"complete-container\">\n          <img src=\"../static/images/check.png\" width=\"100\" className=\"mb-30\"/>\n          <div className=\"h3 mb-20 color-d2 text-center\">Success</div>\n          <div className=\"h5 color-d0 text-center\">You have created a new poll!</div>\n        </div>\n      }\n\n      {!data &&\n        <div className=\"polls-listing-container\">\n          <FormComponent\n            id={null}\n            userId={null}\n            expiry={null}\n            title={null}\n            currentUserId={userId}\n            description={null}\n            options={null}\n            onSubmit={(title, description, options, expiry) => {\n              // Add the poll first\n              addPoll({\n                variables: {\n                  objects: [\n                    {\n                      title,\n                      description,\n                      options,\n                      expiry,\n                      channel_id: channelId,\n                      user_id: userId\n                    }\n                  ]\n                }\n              })\n\n              // And then close the modal\n              // closeAppModal()\n            }}\n          />\n        </div>\n      }\n    </React.Fragment>\n  )\n}\n\nexport default withData(withRouter(Create))\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAUA;AACA;AADA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAMA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AALA;AAAA;AAAA;AAiEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AANA;AAFA;AADA;AAgBA;AACA;AA3BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAiCA;AACA;AACA;;;;A","sourceRoot":""}